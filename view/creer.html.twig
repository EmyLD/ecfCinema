<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creer une fiche</title>
    <title>Creer une fiche</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<main>
    {% if message is null %}
    <div class="container col-md-8">
        <form class="row g-3" action="creer" method="post" name="formulaire">
            <div class="col-md-6">
                <label for="title" class="form-label">
                    <h5>Titre</h5>
                </label>
                <input class="form-control border border-dark" type="text" id="title" placeholder="Renseignez le titre" name="title" required>
            </div>
            <div class="col-md-6">
                <label for="year" class="form-label">
                    <h5>Année</h5>
                </label>
                <input class="form-control border border-dark" type="text" id="year" placeholder="Renseignez l'année" name="year" required>
            </div>
            <div class="col-md-12">
                <label for="poster" class="form-label">
                    <h5>Affiche</h5>
                </label>
                <input class="form-control border border-dark" type="text" id="poster" placeholder="Mettez l'URL de l'affiche" name="poster" required>
            </div>
            <div class="col-md-12">
                <label for="director" class="form-label">
                    <h5>Réalisateur</h5>
                </label>
                <input class="form-control border border-dark" type="text" id="director" placeholder="Mettez le réalisateur" name="director" required>
            </div>
            <div class="col-md-12" id="roles">
                <h5>Rôles</h5>
                <button class="btn btn-secondary rounded border border-dark mb-1" type="button" onclick="addRole()">Ajouter</button>
                <div class="row g-3 align-items-center" id="role1">
                    <div class="col-md-4">
                        <label for="character1" class="form-label"></label>
                        <input class="form-control border border-dark mb-1" type="text" id="character1" placeholder="Personnage" name="character[]" required>
                    </div>
                    <div class="col-md-4">
                        <label for="name1" class="form-label"></label>
                        <input class="form-control border border-dark mb-1" type="text" id="name1" placeholder="Nom" name="name[]" required>
                    </div>
                    <div class="col-md-4">
                        <label for="firstname1" class="form-label"></label>
                        <input class="form-control border border-dark mb-1" type="text" id="firstname1" placeholder="Prénom" name="firstname[]" required>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-center col-12">
                <button class="btn btn-primary mt-1" type="submit">Créer Film</button>
            </div>
        </form>
    </div>
    {% else %}
    <div>
        <p>{{ message }}</p><br>
        {% if movie is defined %}
        <p>{{ movie.getTitle }}: {{ movie.getYear }}: {{ movie.getPoster }}: {{ movie.getDirector }}</p>
        {% endif %}
    </div>
    {% endif %}
</main>

<script>
    var roleCount = 1;

    function addRole() {
        roleCount++;
        const rolesDiv = document.getElementById('roles');

        const roleHtml = `
            <div class="row g-3 align-items-center" id="role${roleCount}">
                <div class="col-md-4">
                    <label for="character${roleCount}" class="form-label"></label>
                    <input class="form-control border border-dark mb-1" type="text" id="character${roleCount}" placeholder="Personnage" name="character[]" required>
                </div>
                <div class="col-md-4">
                    <label for="name${roleCount}" class="form-label"></label>
                    <input class="form-control border border-dark mb-1" type="text" id="name${roleCount}" placeholder="Nom" name="name[]" required>
                </div>
                <div class="col-md-4">
                    <label for="firstname${roleCount}" class="form-label"></label>
                    <input class="form-control border border-dark mb-1" type="text" id="firstname${roleCount}" placeholder="Prénom" name="firstname[]" required>
                </div>
                <button class="btn btn-danger mt-1" type="button" onclick="removeRole(${roleCount})">Supprimer</button>
            </div>
        `;

        const roleElement = document.createElement('div');
        roleElement.innerHTML = roleHtml;
        rolesDiv.appendChild(roleElement);
    }

    function removeRole(roleId) {
        const roleToRemove = document.getElementById('role' + roleId);
        roleToRemove.parentNode.removeChild(roleToRemove);
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
